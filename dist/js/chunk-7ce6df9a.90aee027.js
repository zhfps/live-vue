(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ce6df9a"],{"44c9":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"Roles"},[i("el-card",{directives:[{name:"show",rawName:"v-show",value:e.searchShow,expression:"searchShow"}],staticClass:"tool-card"},[i("el-form",{staticClass:"search",attrs:{"label-width":"80px",inline:!0,model:e.query}},[i("el-form-item",{attrs:{size:"mini",label:"权限描述"}},[i("el-input",{attrs:{placeholder:"权限描述"},model:{value:e.query.description,callback:function(t){e.$set(e.query,"description",t)},expression:"query.description"}})],1),i("el-form-item",{attrs:{size:"mini"}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-search",round:""},on:{click:e.search}},[e._v("搜索")])],1),i("el-form-item",{attrs:{size:"mini"}},[i("el-button",{attrs:{type:"warning",icon:"el-icon-refresh",round:""},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),i("el-card",{staticClass:"table-content"},[i("el-row",{staticClass:"nav-bar"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.show=!e.show}}},[e._v("新增")]),i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.handleUpdateDialog}},[e._v("修改")]),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.handleDelete}},[e._v("删除")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handlePermission}},[e._v("权限分配")]),i("el-button-group",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:function(t){e.searchShow=!e.searchShow}}}),i("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",size:"mini"},on:{click:e.handleRefresh}})],1)],1),i("div",{staticClass:"table"},[i("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:!0,data:e.tableData,"max-height":e.tableMaxHeight,size:"small","highlight-current-row":""},on:{"current-change":e.handleCurrentChange,"sort-change":e.handleSortChange}},[i("el-table-column",{attrs:{type:"index",width:"50"}}),i("el-table-column",{attrs:{prop:"name",label:"权限名",sortable:"custom",width:"180"}}),i("el-table-column",{attrs:{prop:"description",label:"描述",sortable:"custom"}})],1)],1),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{"current-page":e.query.currentPage,"page-sizes":e.pageSizeList,"page-size":e.query.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1)],1),i("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],attrs:{title:"新增",visible:e.show,width:"400px"},on:{"update:visible":function(t){e.show=t}}},[i("el-form",{ref:"menuForm",staticStyle:{"padding-right":"15px"},attrs:{"label-width":"80px",rules:e.rules,model:e.role}},[i("el-form-item",{attrs:{prop:"name",size:"mini",label:"用户名"}},[i("el-input",{attrs:{placeholder:"角色编号"},model:{value:e.role.name,callback:function(t){e.$set(e.role,"name",t)},expression:"role.name"}})],1),i("el-form-item",{attrs:{prop:"description",size:"mini",label:"角色描述"}},[i("el-input",{attrs:{placeholder:"角色描述"},model:{value:e.role.description,callback:function(t){e.$set(e.role,"description",t)},expression:"role.description"}})],1)],1),i("span",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.onSubmit("menuForm")}}},[e._v("确定")]),i("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleCancle("create")}}},[e._v("取消")])],1)],1),i("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],attrs:{title:"修改",visible:e.updateShow,width:"400px"},on:{"update:visible":function(t){e.updateShow=t}}},[i("el-form",{ref:"updateForm",staticStyle:{"padding-right":"15px"},attrs:{"label-width":"80px",rules:e.rules,model:e.update}},[i("el-form-item",{attrs:{prop:"description",size:"mini",label:"角色描述"}},[i("el-input",{attrs:{placeholder:"角色描述"},model:{value:e.update.description,callback:function(t){e.$set(e.update,"description",t)},expression:"update.description"}})],1)],1),i("span",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate("updateForm")}}},[e._v("确定")]),i("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleCancle("update")}}},[e._v("取消")])],1)],1),i("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],attrs:{title:"权限分配",visible:e.permission,width:"400px"},on:{"update:visible":function(t){e.permission=t}}},[i("el-tree",{ref:"tree",attrs:{data:e.permissions,"show-checkbox":"","node-key":"value",props:e.defaultProps,"default-checked-keys":e.setPermissions},on:{check:e.handleSelectNode}}),i("span",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleSetPermissions}},[e._v("确定")]),i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.permission=!1}}},[e._v("取消")])],1)],1)],1)},n=[],a=(i("a4d3"),i("e01a"),i("b0c0"),i("b64b"),i("b85c")),o=i("5530"),r=(i("e5bd"),i("603b"),i("2f62")),l=i("ba9c"),c=i("5c96"),u={name:"Roles",computed:Object(o["a"])({},Object(r["c"])(["rootPath","pageSizeList"])),data:function(){return{permissions:[],defaultProps:{children:"children",label:"label"},query:{description:null,currentPage:1,order:"id",pageSize:30,sortType:1},tableMaxHeight:500,role:{name:"",description:""},total:0,update:{},show:!1,updateShow:!1,tableData:[],searchShow:!1,permission:!1,options:[],rules:{name:[{required:!0,message:"角色不能为空",trigger:"blur"}],description:[{required:!0,message:"角色描述不能为空",trigger:"blur"}]},setPermissions:[]}},watch:{searchShow:function(e,t){this.tableMaxHeight=e?document.body.clientHeight-220-135:document.body.clientHeight-127-135}},created:function(){this.setTable(),this.setSelect()},mounted:function(){var e=this;this.$nextTick((function(){e.handleHeight()})),window.onresize=function(){var t=document.getElementsByClassName("table");e.tableMaxHeight=document.body.clientHeight-t[0].offsetTop-135}},methods:{handleSetPermissions:function(){var e=this;Object(l["s"])(this.update.id,this.setPermissions).then((function(t){t&&(e.setPermissions=[],e.permission=!1)}))},handleGetRolePermission:function(){var e=this;this.setPermissions=[],Object(l["l"])(this.update.id).then((function(t){var i,s=Object(a["a"])(t);try{for(s.s();!(i=s.n()).done;){var n=i.value;e.setPermissions.push(n.permissionId)}}catch(o){s.e(o)}finally{s.f()}return e.$nextTick((function(){e.$refs.tree.setCheckedKeys(e.setPermissions)})),e.permission=!0,t}))},setSelect:function(){var e=this;Object(l["r"])(2).then((function(t){e.permissions=t}))},handleSelectNode:function(e,t){this.setPermissions=t.checkedKeys},handlePermission:function(){Object.keys(this.update).length>0?this.handleGetRolePermission():Object(c["Message"])({type:"info",message:"请选择数据",showClose:!0})},handleSortChange:function(e){"ascending"===e.order?this.query.sortType=2:this.query.sortType=1,this.query.order=e.prop,this.setTable()},handleHeight:function(){var e=document.getElementsByClassName("table");this.tableMaxHeight=document.body.clientHeight-e[0].offsetTop-135},handleSizeChange:function(e){this.query.pageSize=e,this.setTable()},handlePageChange:function(e){this.query.currentPage=e,this.setTable()},handleCancle:function(e){"update"===e?(this.updateShow=!1,this.update={}):"create"===e&&(this.show=!1,this.user={name:"",description:""})},search:function(){this.setTable()},reset:function(){this.query.description=null,this.setTable()},handleRefresh:function(){this.setTable()},handleCurrentChange:function(e){null!=e&&(this.update=e)},handleUpdateDialog:function(){Object.keys(this.update).length>0?this.updateShow=!0:Object(c["Message"])({type:"info",message:"请选择数据",showClose:!0})},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;Object(l["a"])(t.role).then((function(e){e&&(t.setTable(),Object(c["Message"])({type:"success",message:"新增成功",showClose:!0}),t.user={name:"",description:""},t.show=!1)}))}))},handleUpdate:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;Object(l["c"])(t.update).then((function(e){e&&(t.setTable(),Object(c["Message"])({type:"success",message:"修改成功",showClose:!0}),t.update={},t.updateShow=!1)}))}))},handleDelete:function(){var e=this;Object.keys(this.update).length>0?c["MessageBox"].confirm("确定删除".concat(this.update.name?this.update.name:"该","角色吗？")).then((function(){Object(l["h"])(e.update.id).then((function(t){t&&(Object(c["Message"])({type:"success",message:"删除成功",showClose:!0}),e.setTable())}))})):Object(c["Message"])({type:"info",message:"请选择数据",showClose:!0})},setTable:function(){var e=this;Object(l["m"])(this.query).then((function(t){var i=t.list,s=t.total;return e.tableData=i,e.total=s,t}))}}},h=u,d=i("2877"),p=Object(d["a"])(h,s,n,!1,null,null,null);t["default"]=p.exports},e5bd:function(e,t,i){}}]);
//# sourceMappingURL=chunk-7ce6df9a.90aee027.js.map