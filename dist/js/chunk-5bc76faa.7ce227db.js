(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5bc76faa"],{c8df:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Users"},[a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.searchShow,expression:"searchShow"}],staticClass:"tool-card"},[a("el-form",{staticClass:"search",attrs:{"label-width":"80px",inline:!0,model:e.query}},[a("el-form-item",{attrs:{size:"mini",label:"用户名"}},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.query.userName,callback:function(t){e.$set(e.query,"userName",t)},expression:"query.userName"}})],1),a("el-form-item",{attrs:{size:"mini",label:"用户状态"}},[a("el-select",{attrs:{size:"mini",placeholder:"菜单状态"},model:{value:e.query.status,callback:function(t){e.$set(e.query,"status",t)},expression:"query.status"}},[a("el-option",{attrs:{label:"全部",value:"全部"}}),a("el-option",{attrs:{label:"禁用",value:"禁用"}}),a("el-option",{attrs:{label:"启用",value:"启用"}})],1)],1),a("el-form-item",{attrs:{size:"mini"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",round:""},on:{click:e.search}},[e._v("搜索")])],1),a("el-form-item",{attrs:{size:"mini"}},[a("el-button",{attrs:{type:"warning",icon:"el-icon-refresh",round:""},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("el-card",{staticClass:"table-content"},[a("el-row",{staticClass:"nav-bar"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.show=!e.show}}},[e._v("新增")]),a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.handleUpdateDialog}},[e._v("修改")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.handleDelete}},[e._v("删除")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleRole}},[e._v("角色分配")]),a("el-button-group",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:function(t){e.searchShow=!e.searchShow}}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",size:"mini"},on:{click:e.handleRefresh}})],1)],1),a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:!0,data:e.tableData,"max-height":e.tableMaxHeight,size:"small","highlight-current-row":""},on:{"current-change":e.handleCurrentChange,"sort-change":e.handleSortChange}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),a("el-table-column",{attrs:{prop:"username",label:"用户名",sortable:"custom",width:"180"}}),a("el-table-column",{attrs:{prop:"nickname",label:"昵称",sortable:"custom",width:"180"}}),a("el-table-column",{attrs:{prop:"roleName",label:"角色",sortable:"custom",width:"180"}}),a("el-table-column",{attrs:{prop:"icon",align:"center",label:"头像",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("el-avatar",{attrs:{size:"small",src:e.rootPath+s.icon}})]}}])}),a("el-table-column",{attrs:{prop:"phone",label:"电话",width:"180"}}),a("el-table-column",{attrs:{prop:"telephone",label:"移动电话",width:"180"}}),a("el-table-column",{attrs:{prop:"email",label:"邮件",width:"180"}}),a("el-table-column",{attrs:{prop:"birthday",label:"出生年月",sortable:"custom",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",width:"180"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"180"}}),a("el-table-column",{attrs:{prop:"createTime",sortable:"custom",label:"注册时间",width:"180"}})],1)],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.query.currentPage,"page-sizes":e.pageSizeList,"page-size":e.query.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1)],1),a("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],attrs:{title:"新增",visible:e.show,width:"400px"},on:{"update:visible":function(t){e.show=t}}},[a("el-form",{ref:"menuForm",staticStyle:{"padding-right":"15px"},attrs:{"label-width":"80px",rules:e.rules,model:e.user}},[a("el-form-item",{attrs:{prop:"username",size:"mini",label:"用户名"}},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),a("el-form-item",{attrs:{prop:"nickname",size:"mini",label:"昵称"}},[a("el-input",{attrs:{placeholder:"昵称"},model:{value:e.user.nickname,callback:function(t){e.$set(e.user,"nickname",t)},expression:"user.nickname"}})],1),a("el-form-item",{attrs:{prop:"password",size:"mini",label:"密码"}},[a("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1)],1),a("span",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.onSubmit("menuForm")}}},[e._v("确定")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleCancle("create")}}},[e._v("取消")])],1)],1),a("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],attrs:{title:"修改",visible:e.updateShow,width:"400px"},on:{"update:visible":function(t){e.updateShow=t}}},[a("el-form",{ref:"updateForm",staticStyle:{"padding-right":"15px"},attrs:{"label-width":"80px",rules:e.rules,model:e.update}},[a("el-form-item",{attrs:{prop:"username",size:"mini",label:"用户名"}},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.update.username,callback:function(t){e.$set(e.update,"username",t)},expression:"update.username"}})],1),a("el-form-item",{attrs:{prop:"nickname",size:"mini",label:"昵称"}},[a("el-input",{attrs:{placeholder:"昵称"},model:{value:e.update.nickname,callback:function(t){e.$set(e.update,"nickname",t)},expression:"update.nickname"}})],1),a("el-form-item",{attrs:{prop:"password",size:"mini",label:"密码"}},[a("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.update.password,callback:function(t){e.$set(e.update,"password",t)},expression:"update.password"}})],1)],1),a("span",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate("updateForm")}}},[e._v("确定")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleCancle("update")}}},[e._v("取消")])],1)],1),a("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],attrs:{title:"分配角色",visible:e.roleShow,width:"400px"},on:{"update:visible":function(t){e.roleShow=t}}},[a("el-tree",{ref:"tree",attrs:{data:e.roles,"show-checkbox":"","node-key":"id",props:e.defaultProps,"default-checked-keys":e.setRoles},on:{check:e.handleSelectNode}}),a("span",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleSetRole}},[e._v("确定")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.roleShow=!1}}},[e._v("取消")])],1)],1)],1)},n=[],l=(a("b64b"),a("d3b7"),a("b85c")),i=a("5530"),r=(a("cf99"),a("603b"),a("2f62")),o=a("ba9c"),c=a("5c96"),u={name:"Users",computed:Object(i["a"])({},Object(r["c"])(["rootPath","pageSizeList"])),data:function(){return{roleShow:!1,roles:[],setRoles:[],defaultProps:{children:"children",label:"description"},query:{userName:null,status:"全部",currentPage:1,order:"id",pageSize:30,sortType:1},tableMaxHeight:500,user:{username:"",nickname:"",password:""},total:0,update:{},show:!1,updateShow:!1,tableData:[],searchShow:!1,options:[],rules:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],nickname:[{required:!0,message:"昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]}}},watch:{searchShow:function(e,t){this.tableMaxHeight=e?document.body.clientHeight-220-135:document.body.clientHeight-127-135}},created:function(){this.setTable(),this.handleGetAllRoles()},mounted:function(){var e=this;this.$nextTick((function(){e.handleHeight()})),window.onresize=function(){var t=document.getElementsByClassName("table");e.tableMaxHeight=document.body.clientHeight-t[0].offsetTop-135}},methods:{handleGetAllRoles:function(){var e=this;Object(o["j"])().then((function(t){e.roles=t}))},handleSetRole:function(){var e=this;Object(o["t"])(this.update.id,this.setRoles).then((function(t){t&&(e.setRoles=[],e.roleShow=!1)}))},handleRole:function(){Object.keys(this.update).length>0?this.handleGetRoles():Object(c["Message"])({type:"info",message:"请选择数据",showClose:!0})},handleGetRoles:function(){var e=this;this.setRoles=[],Object(o["p"])(this.update.id).then((function(t){var a,s=Object(l["a"])(t);try{for(s.s();!(a=s.n()).done;){var n=a.value;e.setRoles.push(n.userId)}}catch(i){s.e(i)}finally{s.f()}return e.$nextTick((function(){e.$refs.tree.setCheckedKeys(e.setRoles)})),e.roleShow=!0,t}))},handleSelectNode:function(e,t){this.setRoles=t.checkedKeys},handleSortChange:function(e){"ascending"===e.order?this.query.sortType=2:this.query.sortType=1,this.query.order=e.prop,this.setTable()},handleHeight:function(){var e=document.getElementsByClassName("table");this.tableMaxHeight=document.body.clientHeight-e[0].offsetTop-135},handleSizeChange:function(e){this.query.pageSize=e,this.setTable()},handlePageChange:function(e){this.query.currentPage=e,this.setTable()},handleCancle:function(e){"update"===e?(this.updateShow=!1,this.update={id:0}):"create"===e&&(this.show=!1,this.user={username:"",nickname:"",password:""})},search:function(){this.setTable()},reset:function(){this.query.userName=null,this.query.status="全部",this.setTable()},handleRefresh:function(){this.setTable()},handleCurrentChange:function(e){null!=e&&(this.update=e)},handleUpdateDialog:function(){Object.keys(this.update).length>0?this.updateShow=!0:Object(c["Message"])({type:"info",message:"请选择数据",showClose:!0})},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;new Promise((function(e,a){Object(o["b"])(t.user).then((function(a){a&&(t.setTable(),Object(c["Message"])({type:"success",message:"新增成功",showClose:!0}),t.show=!1,e(a))})).catch((function(e){return a(e)}))}))}))},handleUpdate:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;new Promise((function(e,a){Object(o["d"])(t.update).then((function(a){a&&(t.setTable(),Object(c["Message"])({type:"success",message:"修改成功",showClose:!0}),t.updateShow=!1,e(a))})).catch((function(e){return a(e)}))}))}))},handleDelete:function(){var e=this;Object.keys(this.update).length>0?c["MessageBox"].confirm("确定删除".concat(this.update.username?this.update.username:"该","用户吗？")).then((function(){Object(o["i"])(e.update.id).then((function(t){t&&(Object(c["Message"])({type:"success",message:"删除",showClose:!0}),e.setTable())}))})):Object(c["Message"])({type:"info",message:"请选择数据",showClose:!0})},setTable:function(){var e=this;Object(o["q"])(this.query).then((function(t){var a=t.list,s=t.total;return e.tableData=a,e.total=s,t}))}}},h=u,d=a("2877"),p=Object(d["a"])(h,s,n,!1,null,null,null);t["default"]=p.exports},cf99:function(e,t,a){}}]);
//# sourceMappingURL=chunk-5bc76faa.7ce227db.js.map